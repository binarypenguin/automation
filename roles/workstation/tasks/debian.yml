---
- name: Add Yubico Repo
  apt_repository:
    repo: ppa:yubico/stable
    state: present

- name: Add Google Key
  apt_key:
    url: https://dl-ssl.google.com/linux/linux_signing_key.pub
    state: present

# Delete the default list file that we likely created in the past using ansible
- name: Delete dl_google_com_linux_chrome_deb.list
  file:
    path: /etc/apt/sources.list.d/dl_google_com_linux_chrome_deb.list
    state: absent

- name: Add Google Chrome repo
  apt_repository:
    repo: 'deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main'
    # The Google Chrome installer uses this filename. Should prevent duplicate repo errors going forward.
    filename: google-chrome.list
    state: present

- name: Ensure packages are installed
  apt:
    package: "{{ packages }}"
    state: present
  vars:
    packages:
    - cryptsetup
    - gimp
    - google-chrome-stable
    - rsnapshot
    - shutter
    - terminator
    - ubuntu-restricted-extras
    - variety
    - virt-manager
    - yubikey-manager-qt
    - yubioath-desktop
    - yubikey-personalization-gui

- name: Ensure snaps are installed
  snap:
    state: present
    classic: no
    name:
      - bitwarden
      - discord
      - spotify
      - telegram-desktop

- name: Ensure snaps are installed (--classic)
  snap:
    state: present
    classic: yes
    name:
      - atom

- name: Disable guest mode in Ubuntu
  copy:
    src: lightdm/50-no-guest.conf
    dest: /usr/share/lightdm/lightdm.conf.d/50-no-guest.conf
    owner: root
    group: root
    mode: 0644

- name: Create Variety Group
  group:
    name: variety
    state: present

- name: Create global pics folder for lightdm
  file:
    path: /var/cache/variety
    owner: root
    group: variety
    state: directory
    mode: 02777
