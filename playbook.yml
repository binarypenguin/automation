---
- name: Check Ansible Environment
  hosts: localhost
  tasks:
    - name: Checking Ansible Version
      assert:
        that:
          - "{{ ansible_version is defined }}"
          - "{{ ansible_version|version_compare(2.0, '>=') }}"

# Common Configuration
- name: apply common configuration to all nodes
  hosts: all
  become: yes
  roles:
    - health
    - common
    - ANXS.fail2ban

# Bastions Configuration
- name: bastion configuration
  hosts: bastions
  become: yes
  roles:
    - bastion

# Web Server Configuration
- name: web server configuration
  hosts: web
  become: yes
  roles:
    - web/common
    - tools/composer

# Workstation Configuration
- name: workstation configuration
  hosts: workstations
  become: yes
  roles:
    - workstation
    - tools/composer

